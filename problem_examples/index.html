<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>1 - Runners in code - üìà mlrose-ky</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "1 - Runners in code";
        var mkdocs_page_input_path = "problem_examples.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> üìà mlrose-ky
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">üèöÔ∏è Home</a>
    <ul>
    <li class="toctree-l2"><a class="reference internal" href="..#user-guide">User Guide</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="..#tutorial-1-getting-started">Tutorial 1 - Getting Started</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="..#tutorial-2-travelling-saleperson-problems">Tutorial 2 - Travelling Saleperson Problems</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="..#tutorial-3-ml-weight-optimization-problems">Tutorial 3 - ML Weight Optimization Problems</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="..#tutorial-4-using-runners">Tutorial 4 - Using Runners</a>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../about/">Ôºü About</a>
    <ul>
    <li class="toctree-l2"><a class="reference internal" href="../about/#project-background">Project Background</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../about/#main-features">Main Features</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../about/#project-improvements-and-updates">Project Improvements and Updates</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../about/#installation">Installation</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../about/#licensing-authors-acknowledgements">Licensing, Authors, Acknowledgements</a>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="https://github.com/knakamura13/mlrose-ky">üîó Github</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">‚ÜØ Randomized Optimizations</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../opt_probs/">ü§î Optimization Problems</a>
    <ul>
    <li class="toctree-l2"><a class="reference internal" href="../opt_probs/#discrete-optimization-problem">Discrete Optimization Problem</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../opt_probs/#continuous-optimization-problem">Continuous Optimization Problem</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../opt_probs/#travelling-salesperson-optimization-problem">Travelling Salesperson Optimization Problem</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../algorithms/">üõπ Algorithms</a>
    <ul>
    <li class="toctree-l2"><a class="reference internal" href="../algorithms/#hill-climbing">Hill Climbing</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="../algorithms/#references">References</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../algorithms/#random-hill-climbing">Random Hill Climbing</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="../algorithms/#references_1">References</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../algorithms/#simulated-annealing">Simulated Annealing</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="../algorithms/#references_2">References</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../algorithms/#genetic-algorithms">Genetic Algorithms</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="../algorithms/#references_3">References</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../algorithms/#mimic">MIMIC</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="../algorithms/#references_4">References</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../decay/">üìÖ Decay Schedules</a>
    <ul>
    <li class="toctree-l2"><a class="reference internal" href="../decay/#geometric-decay">Geometric Decay</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="../decay/#formula">Formula</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="../decay/#class-declaration">Class declaration</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="../decay/#class-method">Class method</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="../decay/#example">Example</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../decay/#arithmetic-decay">Arithmetic Decay</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="../decay/#formula_1">Formula</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="../decay/#class-declaration_1">Class declaration</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="../decay/#class-method_1">Class method</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="../decay/#example_1">Example</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../decay/#exponential-decay">Exponential Decay</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="../decay/#formula_2">Formula</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="../decay/#class-declaration_2">Class declaration</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="../decay/#class-method_2">Class method</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="../decay/#example_2">Example</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../decay/#write-your-own-custom-schedule">Write your own custom schedule</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="../decay/#example_3">Example</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="../decay/#class-method_3">Class method</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../fitness/">üèÉüèª Fitness Functions</a>
    <ul>
    <li class="toctree-l2"><a class="reference internal" href="../fitness/#one-max">One Max</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="../fitness/#formula">Formula</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="../fitness/#class-declaration">Class declaration</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="../fitness/#class-method">Class method</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="../fitness/#example">Example</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../fitness/#flip-flops">Flip Flops</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="../fitness/#formula_1">Formula</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="../fitness/#class-declaration_1">Class declaration</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="../fitness/#class-method_1">Class method</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="../fitness/#example_1">Example</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../fitness/#four-peaks">Four Peaks</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="../fitness/#formula_2">Formula</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="../fitness/#class-declaration_2">Class declaration</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="../fitness/#class-method_2">Class method</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="../fitness/#example_2">Example</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="../fitness/#references">References</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../fitness/#six-peaks">Six Peaks</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="../fitness/#formula_3">Formula</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="../fitness/#class-declaration_3">Class declaration</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="../fitness/#class-method_3">Class method</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="../fitness/#example_3">Example</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="../fitness/#references_1">References</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../fitness/#continuous-peaks">Continuous Peaks</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="../fitness/#formula_4">Formula</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="../fitness/#class-declaration_4">Class declaration</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="../fitness/#class-method_4">Class method</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="../fitness/#example_4">Example</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../fitness/#knapsack">Knapsack</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="../fitness/#formula_5">Formula</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="../fitness/#class-declaration_5">Class declaration</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="../fitness/#class-method_5">Class method</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="../fitness/#example_5">Example</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../fitness/#travelling-salesman-tsp">Travelling Salesman (TSP)</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="../fitness/#formula_6">Formula</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="../fitness/#class-declaration_6">Class declaration</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="../fitness/#class-method_6">Class method</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="../fitness/#example_6">Example</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../fitness/#n-queens">N-Queens</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="../fitness/#formula_7">Formula</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="../fitness/#class-declaration_7">Class declaration</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="../fitness/#class-method_7">Class method</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="../fitness/#example_7">Example</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="../fitness/#references_2">References</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../fitness/#max-k-color">Max K Color</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="../fitness/#formula_8">Formula</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="../fitness/#class-declaration_8">Class declaration</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="../fitness/#class-method_8">Class method</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="../fitness/#example_8">Example</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../fitness/#write-your-own-fitness-function">Write your own fitness function</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="../fitness/#class-declaration_9">Class declaration</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="../fitness/#class-method_9">Class method</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="../fitness/#example_9">Example</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">üß† Neural Networks</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../neural/">üìâ Backpropagation using ROs</a>
    <ul>
    <li class="toctree-l2"><a class="reference internal" href="../neural/#neural-network">Neural Network</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../neural/#linear-regression">Linear Regression</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../neural/#logistic-regression">Logistic Regression</a>
    </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">üßëüèª‚Äçüíª Tutorials</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../tutorial1/">1 - Getting Started</a>
    <ul>
    <li class="toctree-l2"><a class="reference internal" href="../tutorial1/#what-is-an-optimization-problem">What is an Optimization Problem?</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../tutorial1/#why-use-randomized-optimization">Why use Randomized Optimization?</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../tutorial1/#solving-optimization-problems-with-mlrose-ky">Solving Optimization Problems with mlrose-ky</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../tutorial1/#define-a-fitness-function-object">Define a Fitness Function Object</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../tutorial1/#define-an-optimization-problem-object">Define an Optimization Problem Object</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../tutorial1/#select-and-run-a-randomized-optimization-algorithm">Select and Run a Randomized Optimization Algorithm</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../tutorial1/#summary">Summary</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../tutorial1/#references">References</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tutorial2/">2 - What is a Travelling Salesman Problem?</a>
    <ul>
    <li class="toctree-l2"><a class="reference internal" href="../tutorial2/#what-is-a-travelling-salesperson-problem">What is a Travelling Salesperson Problem?</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../tutorial2/#solving-tsps-with-mlrose-ky">Solving TSPs with mlrose-ky</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../tutorial2/#define-a-fitness-function-object">Define a Fitness Function Object</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../tutorial2/#define-an-optimization-problem-object">Define an Optimization Problem Object</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../tutorial2/#select-and-run-a-randomized-optimization-algorithm">Select and Run a Randomized Optimization Algorithm</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../tutorial2/#summary">Summary</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tutorial3/">3 - What is a Machine Learning Weight Optimization Problem?</a>
    <ul>
    <li class="toctree-l2"><a class="reference internal" href="../tutorial3/#what-is-a-machine-learning-weight-optimization-problem">What is a Machine Learning Weight Optimization Problem?</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../tutorial3/#solving-machine-learning-weight-optimization-problems-with-mlrose-ky">Solving Machine Learning Weight Optimization Problems with mlrose-ky</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="../tutorial3/#example-the-iris-dataset">Example: the Iris Dataset</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../tutorial3/#data-pre-processing">Data Pre-Processing</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../tutorial3/#neural-networks">Neural Networks</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../tutorial3/#linear-and-logistic-regression-models">Linear and Logistic Regression Models</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../tutorial3/#summary">Summary</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../runners/">4 - How to use Runners for Optimization Problems?</a>
    <ul>
    <li class="toctree-l2"><a class="reference internal" href="../runners/#an-example-with-rhc-runner">An example with RHC Runner</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../runners/#use-runners-to-make-your-own-custom-wrapper">Use runners to make your own custom wrapper</a>
    </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">üìù Examples</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">1 - Runners in code</a>
    <ul class="current">
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tutorial_examples/">2 - Fitness function in code</a>
    <ul>
    <li class="toctree-l2"><a class="reference internal" href="../tutorial_examples/#import-libraries">Import Libraries</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../tutorial_examples/#example-1-8-queens-using-pre-defined-fitness-function">Example 1: 8-Queens Using Pre-Defined Fitness Function</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../tutorial_examples/#example-2-8-queens-using-custom-fitness-function">Example 2: 8-Queens Using Custom Fitness Function</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../tutorial_examples/#example-3-travelling-salesperson-using-coordinate-defined-fitness-function">Example 3: Travelling Salesperson Using Coordinate-Defined Fitness Function</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../tutorial_examples/#example-4-travelling-salesperson-using-distance-defined-fitness-function">Example 4: Travelling Salesperson Using Distance-Defined Fitness Function</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../tutorial_examples/#example-5-travelling-salesperson-defining-fitness-function-as-part-of-optimization-problem-definition-step">Example 5: Travelling Salesperson Defining Fitness Function as Part of Optimization Problem Definition Step</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../tutorial_examples/#example-6-fitting-a-neural-network-to-the-iris-dataset">Example 6: Fitting a Neural Network to the Iris Dataset</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../tutorial_examples/#example-7-fitting-a-logistic-regression-to-the-iris-data">Example 7: Fitting a Logistic Regression to the Iris Data</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../tutorial_examples/#example-8-fitting-a-logistic-regression-to-the-iris-data-using-the-neuralnetwork-class">Example 8: Fitting a Logistic Regression to the Iris Data using the NeuralNetwork() class</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../nn_examples/">3 - Using Neural Network Runners</a>
    <ul>
    <li class="toctree-l2"><a class="reference internal" href="../nn_examples/#import-libraries">Import Libraries</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../nn_examples/#generating-sample-data">Generating sample data...</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../nn_examples/#preparing-the-experiment-parameters">Preparing the experiment parameters</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="../nn_examples/#example-1-running-the-skmlprunner">Example 1: Running the SKMLPRunner</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="../nn_examples/#a-clean-data">(a) Clean Data</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="../nn_examples/#b-noisy-data">(b) Noisy Data</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="../nn_examples/#c-extra-data">(c) Extra Data</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../nn_class_with_sklearn/">4 - How to use NeuralNetwork() with sklearn (EASY)</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">üìà mlrose-ky</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">üìù Examples</li>
      <li class="breadcrumb-item active">1 - Runners in code</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h0 id="mlrose_ky-generator-and-runner-usage-examples-andrew-rollings">mlrose_ky Generator and Runner Usage Examples - Andrew Rollings<a class="headerlink" href="#mlrose_ky-generator-and-runner-usage-examples-andrew-rollings" title="Permanent link">#</a></h0>
<p><em>Modified by Kyle Nakamura</em></p>
<h1 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">#</a></h1>
<p>These examples will not solve assignment 2 for you, but they will give you some idea on how to use the problem generator and runner classes.</p>
<p>Hopefully this will result in slightly fewer "How do I \&lt;insert basic usage here&gt;" questions every semester...</p>
<p>Also, and in case it hasn't been made clear enough by the TAs, using any of the visualizations from this tutorial for your report is a bad idea for two reasons: <br />
1. It provides nothing useful as far as the assignment goes, and <br />
2. The TAs will undoubtedly frown upon it.</p>
<p>Visualization is part of the analysis and, for the most part, you're supposed to do that by yourself. Just including<br />
images of the before/after state of a problem really isn't useful in terms of what you're supposed to be analyzing.</p>
<h1 id="import-libraries">Import Libraries<a class="headerlink" href="#import-libraries" title="Permanent link">#</a></h1>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="o">%</span><span class="n">pip</span> <span class="n">install</span> <span class="n">chess</span> <span class="n">IPython</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code>Requirement already satisfied: chess in /Users/kylenakamura/anaconda3/envs/machine-learning/lib/python3.11/site-packages (1.10.0)
Requirement already satisfied: IPython in /Users/kylenakamura/anaconda3/envs/machine-learning/lib/python3.11/site-packages (8.25.0)
Requirement already satisfied: decorator in /Users/kylenakamura/anaconda3/envs/machine-learning/lib/python3.11/site-packages (from IPython) (5.1.1)
Requirement already satisfied: jedi&gt;=0.16 in /Users/kylenakamura/anaconda3/envs/machine-learning/lib/python3.11/site-packages (from IPython) (0.18.1)
Requirement already satisfied: matplotlib-inline in /Users/kylenakamura/anaconda3/envs/machine-learning/lib/python3.11/site-packages (from IPython) (0.1.6)
Requirement already satisfied: prompt-toolkit&lt;3.1.0,&gt;=3.0.41 in /Users/kylenakamura/anaconda3/envs/machine-learning/lib/python3.11/site-packages (from IPython) (3.0.47)
Requirement already satisfied: pygments&gt;=2.4.0 in /Users/kylenakamura/anaconda3/envs/machine-learning/lib/python3.11/site-packages (from IPython) (2.18.0)
Requirement already satisfied: stack-data in /Users/kylenakamura/anaconda3/envs/machine-learning/lib/python3.11/site-packages (from IPython) (0.2.0)
Requirement already satisfied: traitlets&gt;=5.13.0 in /Users/kylenakamura/anaconda3/envs/machine-learning/lib/python3.11/site-packages (from IPython) (5.14.3)
Requirement already satisfied: typing-extensions&gt;=4.6 in /Users/kylenakamura/anaconda3/envs/machine-learning/lib/python3.11/site-packages (from IPython) (4.12.2)
Requirement already satisfied: pexpect&gt;4.3 in /Users/kylenakamura/anaconda3/envs/machine-learning/lib/python3.11/site-packages (from IPython) (4.9.0)
Requirement already satisfied: parso&lt;0.9.0,&gt;=0.8.0 in /Users/kylenakamura/anaconda3/envs/machine-learning/lib/python3.11/site-packages (from jedi&gt;=0.16-&gt;IPython) (0.8.3)
Requirement already satisfied: ptyprocess&gt;=0.5 in /Users/kylenakamura/anaconda3/envs/machine-learning/lib/python3.11/site-packages (from pexpect&gt;4.3-&gt;IPython) (0.7.0)
Requirement already satisfied: wcwidth in /Users/kylenakamura/anaconda3/envs/machine-learning/lib/python3.11/site-packages (from prompt-toolkit&lt;3.1.0,&gt;=3.0.41-&gt;IPython) (0.2.13)
Requirement already satisfied: executing in /Users/kylenakamura/anaconda3/envs/machine-learning/lib/python3.11/site-packages (from stack-data-&gt;IPython) (0.8.3)
Requirement already satisfied: asttokens in /Users/kylenakamura/anaconda3/envs/machine-learning/lib/python3.11/site-packages (from stack-data-&gt;IPython) (2.0.5)
Requirement already satisfied: pure-eval in /Users/kylenakamura/anaconda3/envs/machine-learning/lib/python3.11/site-packages (from stack-data-&gt;IPython) (0.2.2)
Requirement already satisfied: six in /Users/kylenakamura/anaconda3/envs/machine-learning/lib/python3.11/site-packages (from asttokens-&gt;stack-data-&gt;IPython) (1.16.0)
Note: you may need to restart the kernel to use updated packages.
</code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">HTML</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="kn">import</span> <span class="nn">logging</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="kn">import</span> <span class="nn">string</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="kn">from</span> <span class="nn">ast</span> <span class="kn">import</span> <span class="n">literal_eval</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="kn">import</span> <span class="nn">chess</span>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span><span class="p">,</span> <span class="n">OneHotEncoder</span>
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a>
</span><span id="__span-1-17"><a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a><span class="kn">import</span> <span class="nn">mlrose_ky</span> <span class="k">as</span> <span class="nn">mlrose</span>
</span><span id="__span-1-18"><a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a><span class="kn">from</span> <span class="nn">mlrose_ky.generators</span> <span class="kn">import</span> <span class="n">QueensGenerator</span><span class="p">,</span> <span class="n">MaxKColorGenerator</span><span class="p">,</span> <span class="n">TSPGenerator</span>
</span><span id="__span-1-19"><a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a><span class="kn">from</span> <span class="nn">mlrose_ky.runners</span> <span class="kn">import</span> <span class="n">SARunner</span><span class="p">,</span> <span class="n">GARunner</span><span class="p">,</span> <span class="n">NNGSRunner</span>
</span><span id="__span-1-20"><a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a>
</span><span id="__span-1-21"><a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a><span class="c1"># Hide warnings from libraries</span>
</span><span id="__span-1-22"><a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a><span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">)</span>
</span></code></pre></div>
<h1 id="example-1-solving-the-8-queens-problem-using-the-sa-algorithm">Example 1: Solving the 8-Queens problem using the SA algorithm<a class="headerlink" href="#example-1-solving-the-8-queens-problem-using-the-sa-algorithm" title="Permanent link">#</a></h1>
<h2 id="initializing-and-viewing-the-problem">Initializing and viewing the problem<a class="headerlink" href="#initializing-and-viewing-the-problem" title="Permanent link">#</a></h2>
<p>First, we'll use the <code>QueensGenerator</code> to create an instance of the 8-Queens problem.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c1"># Generate a new 8-Queens optimization problem using a fixed seed</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="n">problem</span> <span class="o">=</span> <span class="n">QueensGenerator</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">123456</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</span></code></pre></div>
<p>The initial, un-optimized state can be seen below, both as a list and as a chess board.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c1"># View the initial state as a list</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="n">state</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_state</span><span class="p">()</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Initial state:&#39;</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="c1"># View the initial state as a chess board</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="n">board_layout</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(([</span><span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">)]</span> <span class="k">if</span> <span class="n">s</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="p">[])</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;Q&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="p">([</span><span class="nb">str</span><span class="p">((</span><span class="mi">7</span> <span class="o">-</span> <span class="n">s</span><span class="p">))]</span> <span class="k">if</span> <span class="n">s</span> <span class="o">&lt;</span> <span class="mi">7</span> <span class="k">else</span> <span class="p">[]))</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">state</span><span class="p">])</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="n">chess</span><span class="o">.</span><span class="n">Board</span><span class="p">(</span><span class="n">board_layout</span><span class="p">)</span>  <span class="c1"># You may need to &quot;trust&quot; this notebook for the board visualization to work</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code>Initial state: [2 3 3 2 7 0 1 1]
</code></pre></div>
<p><img alt="svg" src="../problem_examples_files/problem_examples_8_1.svg" /></p>
<h2 id="solving-8-queens-using-a-runner-ie-grid-search">Solving 8-Queens using a Runner (i.e., grid search)<a class="headerlink" href="#solving-8-queens-using-a-runner-ie-grid-search" title="Permanent link">#</a></h2>
<p>Runners are used to execute "grid search" experiments on optimization problems.</p>
<p>We'll use the Simulated Annealing Runner (SARunner) to perform a grid search on the 8-Queens problem and then extract the optimal SA hyperparameters.</p>
<p>Here is a brief explanation of the SARunner parameters used in the example below:<br />
- <code>max_attempts</code>: A list of maximum attempts to try improving the fitness score before terminating a run<br />
- <code>temperature_list</code>: A list of temperatures to try when initializing the SA algorithm's decay function (e.g., <code>GeomDecay(init_temp=1.0)</code>)<br />
- <code>decay_list</code>: A list of decay schedules to try as the SA algorithm's decay function (e.g., <code>GeomDecay</code>, <code>ExpDecay</code>, etc.)<br />
- <code>iteration_list</code>: A list of iterations to snapshot the state of the algorithm at (only determines the rows that the Runner will output)</p>
<p><em>Disclaimer: the values used here are just toy values picked specifically for this example. <br />
You will have to choose your own range of values for your experiments. <br />
I strongly recommend you don't just copy these, or you will find that the grading is unlikely to go the way you would like.</em> </p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c1"># Create an SA Runner instance to solve the problem</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="n">sa</span> <span class="o">=</span> <span class="n">SARunner</span><span class="p">(</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>    <span class="n">problem</span><span class="o">=</span><span class="n">problem</span><span class="p">,</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>    <span class="n">experiment_name</span><span class="o">=</span><span class="s2">&quot;queens_8_sa&quot;</span><span class="p">,</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>    <span class="n">seed</span><span class="o">=</span><span class="mi">123456</span><span class="p">,</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>    <span class="n">output_directory</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># Note: specify an output directory (str) to have these results saved to disk</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>    <span class="n">max_attempts</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>    <span class="n">temperature_list</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">],</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>    <span class="n">decay_list</span><span class="o">=</span><span class="p">[</span><span class="n">mlrose</span><span class="o">.</span><span class="n">GeomDecay</span><span class="p">],</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>    <span class="n">iteration_list</span><span class="o">=</span><span class="mi">2</span> <span class="o">**</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span>  <span class="c1"># list of 11 integers from 2^0 to 2^11</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="p">)</span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a><span class="c1"># Run the SA Runner and retrieve its results</span>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a><span class="n">df_run_stats</span><span class="p">,</span> <span class="n">df_run_curves</span> <span class="o">=</span> <span class="n">sa</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</span></code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="c1"># Calculate some simple stats about the experiment</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="n">temperatures_per_run</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sa</span><span class="o">.</span><span class="n">temperature_list</span><span class="p">))</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="n">decays_per_run</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sa</span><span class="o">.</span><span class="n">decay_list</span><span class="p">))</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="n">iters_per_run</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sa</span><span class="o">.</span><span class="n">iteration_list</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="n">total_runs</span> <span class="o">=</span> <span class="n">temperatures_per_run</span> <span class="o">*</span> <span class="n">decays_per_run</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The experiment executed </span><span class="si">{</span><span class="n">total_runs</span><span class="si">}</span><span class="s2"> runs, each with </span><span class="si">{</span><span class="n">iters_per_run</span><span class="si">}</span><span class="s2"> snapshots at different iterations.&quot;</span><span class="p">)</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;In total, the output dataframe should contain </span><span class="si">{</span><span class="n">total_runs</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">iters_per_run</span><span class="si">}</span><span class="s2"> rows.&quot;</span><span class="p">)</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code>The experiment executed 6 runs, each with 12 snapshots at different iterations.
In total, the output dataframe should contain 72 rows.
</code></pre></div>
<p>The <code>df_run_stats</code> dataframe contains snapshots of the state of the algorithm at the iterations specified in the <code>iteration_list</code>.</p>
<p>Since <code>iterations_list</code> contains 11 numbers, and iteration 0 is always included in the results, each run will take up 12 rows of the dataframe.</p>
<p>The first 12 rows (i.e., results from the first run) are shown below:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="n">HTML</span><span class="p">(</span><span class="n">df_run_stats</span><span class="p">[[</span><span class="s2">&quot;Iteration&quot;</span><span class="p">,</span> <span class="s2">&quot;Fitness&quot;</span><span class="p">,</span> <span class="s2">&quot;FEvals&quot;</span><span class="p">,</span> <span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="s2">&quot;State&quot;</span><span class="p">]][:</span><span class="n">iters_per_run</span><span class="p">]</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</span></code></pre></div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Iteration</th>
      <th>Fitness</th>
      <th>FEvals</th>
      <th>Time</th>
      <th>State</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>11.0</td>
      <td>0</td>
      <td>0.000856</td>
      <td>[1, 2, 2, 1, 0, 3, 7, 3]</td>
    </tr>
    <tr>
      <td>1</td>
      <td>9.0</td>
      <td>2</td>
      <td>0.002331</td>
      <td>[1, 2, 2, 0, 0, 3, 7, 3]</td>
    </tr>
    <tr>
      <td>2</td>
      <td>8.0</td>
      <td>4</td>
      <td>0.002864</td>
      <td>[1, 2, 2, 0, 0, 3, 7, 5]</td>
    </tr>
    <tr>
      <td>4</td>
      <td>8.0</td>
      <td>7</td>
      <td>0.003399</td>
      <td>[1, 2, 2, 5, 0, 3, 7, 5]</td>
    </tr>
    <tr>
      <td>8</td>
      <td>5.0</td>
      <td>13</td>
      <td>0.004127</td>
      <td>[1, 2, 7, 5, 0, 3, 5, 5]</td>
    </tr>
    <tr>
      <td>16</td>
      <td>4.0</td>
      <td>24</td>
      <td>0.005042</td>
      <td>[1, 2, 7, 5, 3, 0, 5, 5]</td>
    </tr>
    <tr>
      <td>32</td>
      <td>4.0</td>
      <td>47</td>
      <td>0.006737</td>
      <td>[1, 5, 7, 5, 0, 0, 3, 4]</td>
    </tr>
    <tr>
      <td>64</td>
      <td>1.0</td>
      <td>86</td>
      <td>0.009472</td>
      <td>[1, 5, 2, 6, 3, 0, 7, 4]</td>
    </tr>
    <tr>
      <td>128</td>
      <td>1.0</td>
      <td>155</td>
      <td>0.014421</td>
      <td>[1, 5, 2, 6, 3, 0, 4, 7]</td>
    </tr>
    <tr>
      <td>256</td>
      <td>1.0</td>
      <td>295</td>
      <td>0.025960</td>
      <td>[1, 7, 2, 6, 3, 5, 0, 4]</td>
    </tr>
    <tr>
      <td>512</td>
      <td>0.0</td>
      <td>461</td>
      <td>0.044061</td>
      <td>[1, 5, 0, 6, 3, 7, 2, 4]</td>
    </tr>
    <tr>
      <td>1024</td>
      <td>0.0</td>
      <td>461</td>
      <td>0.044061</td>
      <td>[1, 5, 0, 6, 3, 7, 2, 4]</td>
    </tr>
  </tbody>
</table>

<p>Some information was intentionally excluded from the previous output. Let's now preview the entirety of the first run:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="n">HTML</span><span class="p">(</span><span class="n">df_run_stats</span><span class="p">[:</span><span class="n">iters_per_run</span><span class="p">]</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</span></code></pre></div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Iteration</th>
      <th>Fitness</th>
      <th>FEvals</th>
      <th>Time</th>
      <th>State</th>
      <th>schedule_type</th>
      <th>schedule_init_temp</th>
      <th>schedule_decay</th>
      <th>schedule_min_temp</th>
      <th>schedule_current_value</th>
      <th>Temperature</th>
      <th>max_iters</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>11.0</td>
      <td>0</td>
      <td>0.000856</td>
      <td>[1, 2, 2, 1, 0, 3, 7, 3]</td>
      <td>geometric</td>
      <td>0.1</td>
      <td>0.99</td>
      <td>0.001</td>
      <td>0.099999</td>
      <td>0.1</td>
      <td>1024</td>
    </tr>
    <tr>
      <td>1</td>
      <td>9.0</td>
      <td>2</td>
      <td>0.002331</td>
      <td>[1, 2, 2, 0, 0, 3, 7, 3]</td>
      <td>geometric</td>
      <td>0.1</td>
      <td>0.99</td>
      <td>0.001</td>
      <td>0.099998</td>
      <td>0.1</td>
      <td>1024</td>
    </tr>
    <tr>
      <td>2</td>
      <td>8.0</td>
      <td>4</td>
      <td>0.002864</td>
      <td>[1, 2, 2, 0, 0, 3, 7, 5]</td>
      <td>geometric</td>
      <td>0.1</td>
      <td>0.99</td>
      <td>0.001</td>
      <td>0.099997</td>
      <td>0.1</td>
      <td>1024</td>
    </tr>
    <tr>
      <td>4</td>
      <td>8.0</td>
      <td>7</td>
      <td>0.003399</td>
      <td>[1, 2, 2, 5, 0, 3, 7, 5]</td>
      <td>geometric</td>
      <td>0.1</td>
      <td>0.99</td>
      <td>0.001</td>
      <td>0.099997</td>
      <td>0.1</td>
      <td>1024</td>
    </tr>
    <tr>
      <td>8</td>
      <td>5.0</td>
      <td>13</td>
      <td>0.004127</td>
      <td>[1, 2, 7, 5, 0, 3, 5, 5]</td>
      <td>geometric</td>
      <td>0.1</td>
      <td>0.99</td>
      <td>0.001</td>
      <td>0.099996</td>
      <td>0.1</td>
      <td>1024</td>
    </tr>
    <tr>
      <td>16</td>
      <td>4.0</td>
      <td>24</td>
      <td>0.005042</td>
      <td>[1, 2, 7, 5, 3, 0, 5, 5]</td>
      <td>geometric</td>
      <td>0.1</td>
      <td>0.99</td>
      <td>0.001</td>
      <td>0.099995</td>
      <td>0.1</td>
      <td>1024</td>
    </tr>
    <tr>
      <td>32</td>
      <td>4.0</td>
      <td>47</td>
      <td>0.006737</td>
      <td>[1, 5, 7, 5, 0, 0, 3, 4]</td>
      <td>geometric</td>
      <td>0.1</td>
      <td>0.99</td>
      <td>0.001</td>
      <td>0.099993</td>
      <td>0.1</td>
      <td>1024</td>
    </tr>
    <tr>
      <td>64</td>
      <td>1.0</td>
      <td>86</td>
      <td>0.009472</td>
      <td>[1, 5, 2, 6, 3, 0, 7, 4]</td>
      <td>geometric</td>
      <td>0.1</td>
      <td>0.99</td>
      <td>0.001</td>
      <td>0.099990</td>
      <td>0.1</td>
      <td>1024</td>
    </tr>
    <tr>
      <td>128</td>
      <td>1.0</td>
      <td>155</td>
      <td>0.014421</td>
      <td>[1, 5, 2, 6, 3, 0, 4, 7]</td>
      <td>geometric</td>
      <td>0.1</td>
      <td>0.99</td>
      <td>0.001</td>
      <td>0.099986</td>
      <td>0.1</td>
      <td>1024</td>
    </tr>
    <tr>
      <td>256</td>
      <td>1.0</td>
      <td>295</td>
      <td>0.025960</td>
      <td>[1, 7, 2, 6, 3, 5, 0, 4]</td>
      <td>geometric</td>
      <td>0.1</td>
      <td>0.99</td>
      <td>0.001</td>
      <td>0.099974</td>
      <td>0.1</td>
      <td>1024</td>
    </tr>
    <tr>
      <td>512</td>
      <td>0.0</td>
      <td>461</td>
      <td>0.044061</td>
      <td>[1, 5, 0, 6, 3, 7, 2, 4]</td>
      <td>geometric</td>
      <td>0.1</td>
      <td>0.99</td>
      <td>0.001</td>
      <td>0.099956</td>
      <td>0.1</td>
      <td>1024</td>
    </tr>
    <tr>
      <td>1024</td>
      <td>0.0</td>
      <td>461</td>
      <td>0.044061</td>
      <td>[1, 5, 0, 6, 3, 7, 2, 4]</td>
      <td>geometric</td>
      <td>0.1</td>
      <td>0.99</td>
      <td>0.001</td>
      <td>0.099956</td>
      <td>0.1</td>
      <td>1024</td>
    </tr>
  </tbody>
</table>

<p><strong>What does all this information tell us about the first run of our experiment?</strong></p>
<ol>
<li><code>Iteration</code> shows the index of the snapshot, with 12 snapshots per run in this example.</li>
<li><code>Fitness</code> shows the fitness score of the state at the corresponding iteration, where 0.0 is optimal for minimization problems.</li>
<li><code>FEvals</code> shows the number of fitness function evaluations performed by the algorithm at the corresponding iteration.</li>
<li><code>Time</code> shows the time elapsed (calculated using <code>time.perf_counter()</code>) up to the corresponding iteration.</li>
<li><code>State</code> shows the state of the algorithm at the corresponding iteration (see <code>mlrose_ky.fitness.queens</code> for more details).</li>
<li><code>Temperature</code> shows the decay function (and its parameters) that was used for this run. We will have 6 unique values in this column, one for each run.</li>
<li><code>max_iters</code> shows the maximum number of iterations allowed for the algorithm to run. It defaults to <code>max(iteration_list)</code> for all Runners, which is 1024 in this case.</li>
</ol>
<p>To pick out the most performant run from the dataframe, we need to find the row with the best fitness.<br />
Since Queens is a minimization problem, we're looking for the row with minimal fitness (i.e., zero).</p>
<p>It's likely that multiple runs will achieve the same fitness, so we need to find the run that achieved the best <code>Fitness</code> in the fewest <code>FEvals</code> (<em>Note: we could make this selection using <code>Iterations</code> or <code>Time</code> if we so desired.</em>)</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="n">best_fitness</span> <span class="o">=</span> <span class="n">df_run_stats</span><span class="p">[</span><span class="s2">&quot;Fitness&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>  <span class="c1"># Should be 0.0 in this case</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="c1"># Get all runs with the best fitness value</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="n">best_runs</span> <span class="o">=</span> <span class="n">df_run_stats</span><span class="p">[</span><span class="n">df_run_stats</span><span class="p">[</span><span class="s2">&quot;Fitness&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">best_fitness</span><span class="p">]</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="n">best_runs</span>
</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Iteration</th>
      <th>Fitness</th>
      <th>FEvals</th>
      <th>Time</th>
      <th>State</th>
      <th>schedule_type</th>
      <th>schedule_init_temp</th>
      <th>schedule_decay</th>
      <th>schedule_min_temp</th>
      <th>schedule_current_value</th>
      <th>Temperature</th>
      <th>max_iters</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10</th>
      <td>512</td>
      <td>0.0</td>
      <td>461</td>
      <td>0.044061</td>
      <td>[1, 5, 0, 6, 3, 7, 2, 4]</td>
      <td>geometric</td>
      <td>0.1</td>
      <td>0.99</td>
      <td>0.001</td>
      <td>0.099956</td>
      <td>0.1</td>
      <td>1024</td>
    </tr>
    <tr>
      <th>11</th>
      <td>1024</td>
      <td>0.0</td>
      <td>461</td>
      <td>0.044061</td>
      <td>[1, 5, 0, 6, 3, 7, 2, 4]</td>
      <td>geometric</td>
      <td>0.1</td>
      <td>0.99</td>
      <td>0.001</td>
      <td>0.099956</td>
      <td>0.1</td>
      <td>1024</td>
    </tr>
    <tr>
      <th>22</th>
      <td>512</td>
      <td>0.0</td>
      <td>461</td>
      <td>0.040817</td>
      <td>[1, 5, 0, 6, 3, 7, 2, 4]</td>
      <td>geometric</td>
      <td>0.5</td>
      <td>0.99</td>
      <td>0.001</td>
      <td>0.499795</td>
      <td>0.5</td>
      <td>1024</td>
    </tr>
    <tr>
      <th>23</th>
      <td>1024</td>
      <td>0.0</td>
      <td>461</td>
      <td>0.040817</td>
      <td>[1, 5, 0, 6, 3, 7, 2, 4]</td>
      <td>geometric</td>
      <td>0.5</td>
      <td>0.99</td>
      <td>0.001</td>
      <td>0.499795</td>
      <td>0.5</td>
      <td>1024</td>
    </tr>
    <tr>
      <th>58</th>
      <td>512</td>
      <td>0.0</td>
      <td>427</td>
      <td>0.044455</td>
      <td>[7, 1, 3, 0, 6, 4, 2, 5]</td>
      <td>geometric</td>
      <td>2.0</td>
      <td>0.99</td>
      <td>0.001</td>
      <td>1.999107</td>
      <td>2.0</td>
      <td>1024</td>
    </tr>
    <tr>
      <th>59</th>
      <td>1024</td>
      <td>0.0</td>
      <td>427</td>
      <td>0.044455</td>
      <td>[7, 1, 3, 0, 6, 4, 2, 5]</td>
      <td>geometric</td>
      <td>2.0</td>
      <td>0.99</td>
      <td>0.001</td>
      <td>1.999107</td>
      <td>2.0</td>
      <td>1024</td>
    </tr>
    <tr>
      <th>70</th>
      <td>512</td>
      <td>0.0</td>
      <td>583</td>
      <td>0.061001</td>
      <td>[6, 0, 2, 7, 5, 3, 1, 4]</td>
      <td>geometric</td>
      <td>5.0</td>
      <td>0.99</td>
      <td>0.001</td>
      <td>4.996936</td>
      <td>5.0</td>
      <td>1024</td>
    </tr>
    <tr>
      <th>71</th>
      <td>1024</td>
      <td>0.0</td>
      <td>583</td>
      <td>0.061001</td>
      <td>[6, 0, 2, 7, 5, 3, 1, 4]</td>
      <td>geometric</td>
      <td>5.0</td>
      <td>0.99</td>
      <td>0.001</td>
      <td>4.996936</td>
      <td>5.0</td>
      <td>1024</td>
    </tr>
  </tbody>
</table>
</div>

<p>This gives us our candidates for the best run. </p>
<p>The best run will be the one that achieved the best fitness in the fewest evaluations.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="n">minimum_evaluations</span> <span class="o">=</span> <span class="n">best_runs</span><span class="p">[</span><span class="s2">&quot;FEvals&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>  <span class="c1"># Should be 461 in this case</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="c1"># Extract the best run with the minimum number of evaluations</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="n">best_run</span> <span class="o">=</span> <span class="n">best_runs</span><span class="p">[</span><span class="n">best_runs</span><span class="p">[</span><span class="s2">&quot;FEvals&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">minimum_evaluations</span><span class="p">]</span>
</span></code></pre></div>
<p>The best run using these criteria is as follows:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="nb">print</span><span class="p">(</span><span class="n">best_run</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code>Iteration                                      512
Fitness                                        0.0
FEvals                                         427
Time                                      0.044455
State                     [7, 1, 3, 0, 6, 4, 2, 5]
schedule_type                            geometric
schedule_init_temp                             2.0
schedule_decay                                0.99
schedule_min_temp                            0.001
schedule_current_value                    1.999107
Temperature                                    2.0
max_iters                                     1024
Name: 58, dtype: object
</code></pre></div>
<p>Which has the following identifying state information:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="n">best_temperature_param</span> <span class="o">=</span> <span class="n">best_run</span><span class="p">[</span><span class="s2">&quot;Temperature&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">init_temp</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="n">best_temperature_param</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code>2.0
</code></pre></div>
<p>To map this result back to the original output of the Runner, we are looking for all rows in <code>df_run_stats</code> where the temperature is equal to 2.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="n">run_stats_best_run</span> <span class="o">=</span> <span class="n">df_run_stats</span><span class="p">[</span><span class="n">df_run_stats</span><span class="p">[</span><span class="s2">&quot;schedule_init_temp&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">best_temperature_param</span><span class="p">]</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="n">run_stats_best_run</span><span class="p">[[</span><span class="s2">&quot;Iteration&quot;</span><span class="p">,</span> <span class="s2">&quot;Fitness&quot;</span><span class="p">,</span> <span class="s2">&quot;FEvals&quot;</span><span class="p">,</span> <span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="s2">&quot;State&quot;</span><span class="p">]]</span>
</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Iteration</th>
      <th>Fitness</th>
      <th>FEvals</th>
      <th>Time</th>
      <th>State</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>48</th>
      <td>0</td>
      <td>11.0</td>
      <td>0</td>
      <td>0.000136</td>
      <td>[1, 2, 2, 1, 0, 3, 7, 3]</td>
    </tr>
    <tr>
      <th>49</th>
      <td>1</td>
      <td>9.0</td>
      <td>2</td>
      <td>0.001460</td>
      <td>[1, 2, 2, 0, 0, 3, 7, 3]</td>
    </tr>
    <tr>
      <th>50</th>
      <td>2</td>
      <td>8.0</td>
      <td>4</td>
      <td>0.002754</td>
      <td>[1, 2, 2, 0, 0, 3, 7, 5]</td>
    </tr>
    <tr>
      <th>51</th>
      <td>4</td>
      <td>8.0</td>
      <td>7</td>
      <td>0.004162</td>
      <td>[1, 2, 2, 5, 0, 3, 7, 5]</td>
    </tr>
    <tr>
      <th>52</th>
      <td>8</td>
      <td>7.0</td>
      <td>14</td>
      <td>0.005876</td>
      <td>[1, 2, 2, 5, 0, 3, 5, 5]</td>
    </tr>
    <tr>
      <th>53</th>
      <td>16</td>
      <td>6.0</td>
      <td>27</td>
      <td>0.007869</td>
      <td>[3, 2, 3, 5, 0, 1, 5, 5]</td>
    </tr>
    <tr>
      <th>54</th>
      <td>32</td>
      <td>4.0</td>
      <td>57</td>
      <td>0.011020</td>
      <td>[3, 5, 6, 5, 5, 0, 4, 7]</td>
    </tr>
    <tr>
      <th>55</th>
      <td>64</td>
      <td>5.0</td>
      <td>114</td>
      <td>0.015731</td>
      <td>[2, 0, 3, 6, 1, 2, 1, 7]</td>
    </tr>
    <tr>
      <th>56</th>
      <td>128</td>
      <td>3.0</td>
      <td>205</td>
      <td>0.022950</td>
      <td>[2, 0, 6, 3, 5, 0, 4, 3]</td>
    </tr>
    <tr>
      <th>57</th>
      <td>256</td>
      <td>2.0</td>
      <td>358</td>
      <td>0.036341</td>
      <td>[7, 1, 3, 6, 6, 4, 0, 5]</td>
    </tr>
    <tr>
      <th>58</th>
      <td>512</td>
      <td>0.0</td>
      <td>427</td>
      <td>0.044455</td>
      <td>[7, 1, 3, 0, 6, 4, 2, 5]</td>
    </tr>
    <tr>
      <th>59</th>
      <td>1024</td>
      <td>0.0</td>
      <td>427</td>
      <td>0.044455</td>
      <td>[7, 1, 3, 0, 6, 4, 2, 5]</td>
    </tr>
  </tbody>
</table>
</div>

<p>And the best state associated with this is:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="n">best_state</span> <span class="o">=</span> <span class="n">run_stats_best_run</span><span class="p">[[</span><span class="s2">&quot;schedule_current_value&quot;</span><span class="p">,</span> <span class="s2">&quot;schedule_init_temp&quot;</span><span class="p">,</span> <span class="s2">&quot;schedule_min_temp&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="n">best_state</span>
</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>schedule_current_value</th>
      <th>schedule_init_temp</th>
      <th>schedule_min_temp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>59</th>
      <td>1.999107</td>
      <td>2.0</td>
      <td>0.001</td>
    </tr>
  </tbody>
</table>
</div>

<p>The final state is as follows:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="n">state</span> <span class="o">=</span> <span class="n">literal_eval</span><span class="p">(</span><span class="n">run_stats_best_run</span><span class="p">[</span><span class="s2">&quot;State&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="n">board_layout</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(([</span><span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">)]</span> <span class="k">if</span> <span class="n">s</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="p">[])</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;Q&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="p">([</span><span class="nb">str</span><span class="p">((</span><span class="mi">7</span> <span class="o">-</span> <span class="n">s</span><span class="p">))]</span> <span class="k">if</span> <span class="n">s</span> <span class="o">&lt;</span> <span class="mi">7</span> <span class="k">else</span> <span class="p">[]))</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">state</span><span class="p">])</span>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="n">board</span> <span class="o">=</span> <span class="n">chess</span><span class="o">.</span><span class="n">Board</span><span class="p">(</span><span class="n">board_layout</span><span class="p">)</span>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="n">board</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code>[7, 1, 3, 0, 6, 4, 2, 5]
</code></pre></div>
<p><img alt="svg" src="../problem_examples_files/problem_examples_29_1.svg" /></p>
<h2 id="example-2-generating-and-running-max-k-color-using-the-ga-algorithm">Example 2: Generating and Running Max K Color using the GA algorithm<a class="headerlink" href="#example-2-generating-and-running-max-k-color-using-the-ga-algorithm" title="Permanent link">#</a></h2>
<div class="language-python highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="c1"># Generate a new Max K problem using a fixed seed.</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="n">problem</span> <span class="o">=</span> <span class="n">MaxKColorGenerator</span><span class="p">()</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">123456</span><span class="p">,</span> <span class="n">number_of_nodes</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">max_connections_per_node</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">max_colors</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</span></code></pre></div>
<p>The input graph generated for the problem looks like this:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">problem</span><span class="o">.</span><span class="n">source_graph</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">spring_layout</span><span class="p">(</span><span class="n">problem</span><span class="o">.</span><span class="n">source_graph</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></code></pre></div>
<p><img alt="png" src="../problem_examples_files/problem_examples_33_0.png" /></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="c1"># create a runner class and solve the problem</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="n">ga</span> <span class="o">=</span> <span class="n">GARunner</span><span class="p">(</span>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>    <span class="n">problem</span><span class="o">=</span><span class="n">problem</span><span class="p">,</span>
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>    <span class="n">experiment_name</span><span class="o">=</span><span class="s2">&quot;max_k_ga&quot;</span><span class="p">,</span>
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>    <span class="n">output_directory</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># note: specify an output directory to have results saved to disk</span>
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>    <span class="n">seed</span><span class="o">=</span><span class="mi">123456</span><span class="p">,</span>
</span><span id="__span-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a>    <span class="n">iteration_list</span><span class="o">=</span><span class="mi">2</span> <span class="o">**</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span>
</span><span id="__span-17-8"><a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a>    <span class="n">population_sizes</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
</span><span id="__span-17-9"><a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a>    <span class="n">mutation_rates</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
</span><span id="__span-17-10"><a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a><span class="p">)</span>
</span><span id="__span-17-11"><a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a>
</span><span id="__span-17-12"><a id="__codelineno-17-12" name="__codelineno-17-12" href="#__codelineno-17-12"></a><span class="c1"># the two data frames will contain the results</span>
</span><span id="__span-17-13"><a id="__codelineno-17-13" name="__codelineno-17-13" href="#__codelineno-17-13"></a><span class="n">df_run_stats</span><span class="p">,</span> <span class="n">df_run_curves</span> <span class="o">=</span> <span class="n">ga</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</span></code></pre></div>
<p>The preceding code will run the <code>GA</code> algorithm nine times for at most 1024 iterations per run.<br />
Each run is a permutation from the list of <code>population_sizes</code> and <code>mutation_rates</code>.</p>
<p>Note that the initial state parameters here are just toy values picked specifically<br />
for this example. You will have to choose your own range of values for your<br />
assignment. I strongly recommend you don't just copy these, or you will find<br />
that the grading is unlikely to go the way you would like.</p>
<p>Really. I mean it... A mutation rate of 0.5 is little better than a pure random search.</p>
<p>The output in the <code>df_run_stats</code> dataframe contains snapshots of the state of the algorithm at the iterations<br />
specified in the <code>iteration_list</code> passed into the runner class.</p>
<p>The first row (corresponding to the first run of this algorithm) are as follows:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="n">df_run_stats</span><span class="p">[[</span><span class="s2">&quot;Iteration&quot;</span><span class="p">,</span> <span class="s2">&quot;Fitness&quot;</span><span class="p">,</span> <span class="s2">&quot;FEvals&quot;</span><span class="p">,</span> <span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="s2">&quot;State&quot;</span><span class="p">]][</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Iteration</th>
      <th>Fitness</th>
      <th>FEvals</th>
      <th>Time</th>
      <th>State</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>3.0</td>
      <td>10</td>
      <td>0.000702</td>
      <td>[1, 2, 2, 1, 0, 0, 0, 0, 2, 2]</td>
    </tr>
  </tbody>
</table>
</div>

<p>The state information is excluded from the previous output.</p>
<p>A sample of this is below:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="n">state_sample</span> <span class="o">=</span> <span class="n">df_run_stats</span><span class="p">[[</span><span class="s2">&quot;Population Size&quot;</span><span class="p">,</span> <span class="s2">&quot;Mutation Rate&quot;</span><span class="p">]][:</span><span class="mi">1</span><span class="p">]</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="n">state_sample</span>
</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Population Size</th>
      <th>Mutation Rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10</td>
      <td>0.1</td>
    </tr>
  </tbody>
</table>
</div>

<p>So, to pick out the most performant run from the dataframe, you need to find the row with the best fitness.<br />
As Max-K-Color is a minimization problem, you'd pick the row with the minimum fitness.</p>
<p>However, I'm going to look in the <code>run_curves</code> (which stores minimal basic information every iteration) to<br />
find out which input state achieved the best fitness in the fewest fitness evaluations.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="n">best_fitness</span> <span class="o">=</span> <span class="n">df_run_curves</span><span class="p">[</span><span class="s2">&quot;Fitness&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="n">best_runs</span> <span class="o">=</span> <span class="n">df_run_curves</span><span class="p">[</span><span class="n">df_run_curves</span><span class="p">[</span><span class="s2">&quot;Fitness&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">best_fitness</span><span class="p">]</span>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="n">best_runs</span>
</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Iteration</th>
      <th>Time</th>
      <th>Fitness</th>
      <th>FEvals</th>
      <th>Population Size</th>
      <th>Mutation Rate</th>
      <th>max_iters</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>0.003967</td>
      <td>0.0</td>
      <td>57.0</td>
      <td>10</td>
      <td>0.1</td>
      <td>1024</td>
    </tr>
    <tr>
      <th>9</th>
      <td>4</td>
      <td>0.003967</td>
      <td>0.0</td>
      <td>57.0</td>
      <td>10</td>
      <td>0.2</td>
      <td>1024</td>
    </tr>
    <tr>
      <th>18</th>
      <td>8</td>
      <td>0.001445</td>
      <td>0.0</td>
      <td>101.0</td>
      <td>10</td>
      <td>0.5</td>
      <td>1024</td>
    </tr>
    <tr>
      <th>24</th>
      <td>5</td>
      <td>0.000106</td>
      <td>0.0</td>
      <td>127.0</td>
      <td>20</td>
      <td>0.1</td>
      <td>1024</td>
    </tr>
    <tr>
      <th>27</th>
      <td>2</td>
      <td>0.003304</td>
      <td>0.0</td>
      <td>64.0</td>
      <td>20</td>
      <td>0.2</td>
      <td>1024</td>
    </tr>
    <tr>
      <th>31</th>
      <td>3</td>
      <td>0.003797</td>
      <td>0.0</td>
      <td>85.0</td>
      <td>20</td>
      <td>0.5</td>
      <td>1024</td>
    </tr>
    <tr>
      <th>41</th>
      <td>9</td>
      <td>0.001615</td>
      <td>0.0</td>
      <td>511.0</td>
      <td>50</td>
      <td>0.1</td>
      <td>1024</td>
    </tr>
    <tr>
      <th>45</th>
      <td>3</td>
      <td>0.003797</td>
      <td>0.0</td>
      <td>205.0</td>
      <td>50</td>
      <td>0.2</td>
      <td>1024</td>
    </tr>
    <tr>
      <th>50</th>
      <td>4</td>
      <td>0.003967</td>
      <td>0.0</td>
      <td>256.0</td>
      <td>50</td>
      <td>0.5</td>
      <td>1024</td>
    </tr>
  </tbody>
</table>
</div>

<p>This gives us nine candidates for the best run. We are going to pick the one with<br />
that reached the best fitness value in the fewest number of evaluations.</p>
<p>(We could also have chosen to use <code>Iterations</code> as our criteria.)</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="n">minimum_evaluations</span> <span class="o">=</span> <span class="n">best_runs</span><span class="p">[</span><span class="s2">&quot;FEvals&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="n">best_run</span> <span class="o">=</span> <span class="n">best_runs</span><span class="p">[</span><span class="n">best_runs</span><span class="p">[</span><span class="s2">&quot;FEvals&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">minimum_evaluations</span><span class="p">]</span>
</span></code></pre></div>
<p>The best runs using these criteria is as follows:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="n">best_run</span>
</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Iteration</th>
      <th>Time</th>
      <th>Fitness</th>
      <th>FEvals</th>
      <th>Population Size</th>
      <th>Mutation Rate</th>
      <th>max_iters</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>0.003967</td>
      <td>0.0</td>
      <td>57.0</td>
      <td>10</td>
      <td>0.1</td>
      <td>1024</td>
    </tr>
    <tr>
      <th>9</th>
      <td>4</td>
      <td>0.003967</td>
      <td>0.0</td>
      <td>57.0</td>
      <td>10</td>
      <td>0.2</td>
      <td>1024</td>
    </tr>
  </tbody>
</table>
</div>

<p>We will arbitrarily pick the first row for this example,<br />
which has the following identifying state information:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="n">best_mr</span> <span class="o">=</span> <span class="n">best_run</span><span class="p">[</span><span class="s2">&quot;Mutation Rate&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="n">best_pop_size</span> <span class="o">=</span> <span class="n">best_run</span><span class="p">[</span><span class="s2">&quot;Population Size&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Best Mutation Rate: </span><span class="si">{</span><span class="n">best_mr</span><span class="si">}</span><span class="s2">, best Population Size: </span><span class="si">{</span><span class="n">best_pop_size</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code>Best Mutation Rate: 0.1, best Population Size: 10
</code></pre></div>
<p>To map this back to the <code>run_stats</code> we look at the configuration data included in<br />
the curve data. The curve data includes at least the minimum identifying information<br />
to determine which run each row came from.</p>
<p>In this case, the values we are looking for are the <code>Mutation Rate</code> and <code>Population Size</code>.</p>
<p>So, we are looking for all rows in <code>df_run_stats</code> where the mutation rate and population size are equal to our best values.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="n">run_stats_best_run</span> <span class="o">=</span> <span class="n">df_run_stats</span><span class="p">[(</span><span class="n">df_run_stats</span><span class="p">[</span><span class="s2">&quot;Mutation Rate&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">best_mr</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df_run_stats</span><span class="p">[</span><span class="s2">&quot;Population Size&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">best_pop_size</span><span class="p">)]</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="n">run_stats_best_run</span><span class="p">[[</span><span class="s2">&quot;Iteration&quot;</span><span class="p">,</span> <span class="s2">&quot;Fitness&quot;</span><span class="p">,</span> <span class="s2">&quot;FEvals&quot;</span><span class="p">,</span> <span class="s2">&quot;Time&quot;</span><span class="p">]]</span>
</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Iteration</th>
      <th>Fitness</th>
      <th>FEvals</th>
      <th>Time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>3.0</td>
      <td>10</td>
      <td>0.000702</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>3.0</td>
      <td>21</td>
      <td>0.002124</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>2.0</td>
      <td>33</td>
      <td>0.003304</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>0.0</td>
      <td>57</td>
      <td>0.003967</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8</td>
      <td>0.0</td>
      <td>57</td>
      <td>0.003967</td>
    </tr>
    <tr>
      <th>5</th>
      <td>16</td>
      <td>0.0</td>
      <td>57</td>
      <td>0.003967</td>
    </tr>
    <tr>
      <th>6</th>
      <td>32</td>
      <td>0.0</td>
      <td>57</td>
      <td>0.003967</td>
    </tr>
    <tr>
      <th>7</th>
      <td>64</td>
      <td>0.0</td>
      <td>57</td>
      <td>0.003967</td>
    </tr>
    <tr>
      <th>8</th>
      <td>128</td>
      <td>0.0</td>
      <td>57</td>
      <td>0.003967</td>
    </tr>
    <tr>
      <th>9</th>
      <td>256</td>
      <td>0.0</td>
      <td>57</td>
      <td>0.003967</td>
    </tr>
    <tr>
      <th>10</th>
      <td>512</td>
      <td>0.0</td>
      <td>57</td>
      <td>0.003967</td>
    </tr>
    <tr>
      <th>11</th>
      <td>1024</td>
      <td>0.0</td>
      <td>57</td>
      <td>0.003967</td>
    </tr>
  </tbody>
</table>
</div>

<p>And the best state associated with this is:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="n">best_state</span> <span class="o">=</span> <span class="n">run_stats_best_run</span><span class="p">[[</span><span class="s2">&quot;State&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="n">best_state</span>
</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>State</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>11</th>
      <td>[0, 1, 2, 0, 0, 2, 0, 1, 2, 1]</td>
    </tr>
  </tbody>
</table>
</div>

<p>For the following node ordering:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="nb">print</span><span class="p">([</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">problem</span><span class="o">.</span><span class="n">source_graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">])</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code>[0, 2, 8, 1, 3, 4, 6, 7, 9, 5]
</code></pre></div>
<p>Reordering the state by ascending node number gives the following:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="n">color_indexes</span> <span class="o">=</span> <span class="n">literal_eval</span><span class="p">(</span><span class="n">run_stats_best_run</span><span class="p">[</span><span class="s2">&quot;State&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="n">ordered_state</span> <span class="o">=</span> <span class="p">[</span><span class="n">color_indexes</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">problem</span><span class="o">.</span><span class="n">source_graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">]</span>
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a><span class="nb">print</span><span class="p">(</span><span class="n">ordered_state</span><span class="p">)</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code>[0, 2, 2, 1, 0, 0, 0, 1, 1, 2]
</code></pre></div>
<p>Which results in a graph looking like this:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;lightcoral&quot;</span><span class="p">,</span> <span class="s2">&quot;lightgreen&quot;</span><span class="p">,</span> <span class="s2">&quot;yellow&quot;</span><span class="p">]</span>
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="n">node_color_map</span> <span class="o">=</span> <span class="p">[</span><span class="n">colors</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">ordered_state</span><span class="p">]</span>
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a>
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a><span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">problem</span><span class="o">.</span><span class="n">source_graph</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">spring_layout</span><span class="p">(</span><span class="n">problem</span><span class="o">.</span><span class="n">source_graph</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span> <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">node_color</span><span class="o">=</span><span class="n">node_color_map</span><span class="p">)</span>
</span><span id="__span-28-5"><a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></code></pre></div>
<p><img alt="png" src="../problem_examples_files/problem_examples_56_0.png" /></p>
<h2 id="example-3-generating-and-running-tsp-using-the-ga-algorithm">Example 3: Generating and Running TSP using the GA algorithm<a class="headerlink" href="#example-3-generating-and-running-tsp-using-the-ga-algorithm" title="Permanent link">#</a></h2>
<div class="language-python highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="c1"># Generate a new TSP problem using a fixed seed.</span>
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a><span class="n">problem</span> <span class="o">=</span> <span class="n">TSPGenerator</span><span class="p">()</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">123456</span><span class="p">,</span> <span class="n">number_of_cities</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</span></code></pre></div>
<p>The input graph generated for the problem looks like this:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Prepare 2 plots</span>
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
</span><span id="__span-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">problem</span><span class="o">.</span><span class="n">coords</span><span class="p">):</span>
</span><span id="__span-30-5"><a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;cornflowerblue&quot;</span><span class="p">)</span>  <span class="c1"># plot A</span>
</span><span id="__span-30-6"><a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a><span class="n">node_labels</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_uppercase</span><span class="p">)</span> <span class="k">if</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">problem</span><span class="o">.</span><span class="n">source_graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">)}</span>
</span><span id="__span-30-7"><a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">node_labels</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="__span-30-8"><a id="__codelineno-30-8" name="__codelineno-30-8" href="#__codelineno-30-8"></a>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="__span-30-9"><a id="__codelineno-30-9" name="__codelineno-30-9" href="#__codelineno-30-9"></a><span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
</span><span id="__span-30-10"><a id="__codelineno-30-10" name="__codelineno-30-10" href="#__codelineno-30-10"></a>    <span class="n">x</span><span class="p">,</span>
</span><span id="__span-30-11"><a id="__codelineno-30-11" name="__codelineno-30-11" href="#__codelineno-30-11"></a>    <span class="n">y</span><span class="p">,</span>
</span><span id="__span-30-12"><a id="__codelineno-30-12" name="__codelineno-30-12" href="#__codelineno-30-12"></a>    <span class="n">node_labels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
</span><span id="__span-30-13"><a id="__codelineno-30-13" name="__codelineno-30-13" href="#__codelineno-30-13"></a>    <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
</span><span id="__span-30-14"><a id="__codelineno-30-14" name="__codelineno-30-14" href="#__codelineno-30-14"></a>    <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
</span><span id="__span-30-15"><a id="__codelineno-30-15" name="__codelineno-30-15" href="#__codelineno-30-15"></a>    <span class="n">c</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
</span><span id="__span-30-16"><a id="__codelineno-30-16" name="__codelineno-30-16" href="#__codelineno-30-16"></a>    <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span>
</span><span id="__span-30-17"><a id="__codelineno-30-17" name="__codelineno-30-17" href="#__codelineno-30-17"></a>    <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;circle,pad=0.15&quot;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s2">&quot;cornflowerblue&quot;</span><span class="p">),</span>
</span><span id="__span-30-18"><a id="__codelineno-30-18" name="__codelineno-30-18" href="#__codelineno-30-18"></a><span class="p">)</span>
</span><span id="__span-30-19"><a id="__codelineno-30-19" name="__codelineno-30-19" href="#__codelineno-30-19"></a>
</span><span id="__span-30-20"><a id="__codelineno-30-20" name="__codelineno-30-20" href="#__codelineno-30-20"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="__span-30-21"><a id="__codelineno-30-21" name="__codelineno-30-21" href="#__codelineno-30-21"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></code></pre></div>
<p><img alt="png" src="../problem_examples_files/problem_examples_60_0.png" /></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="c1"># create a runner class and solve the problem</span>
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a><span class="n">ga</span> <span class="o">=</span> <span class="n">GARunner</span><span class="p">(</span>
</span><span id="__span-31-3"><a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a>    <span class="n">problem</span><span class="o">=</span><span class="n">problem</span><span class="p">,</span>
</span><span id="__span-31-4"><a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a>    <span class="n">experiment_name</span><span class="o">=</span><span class="s2">&quot;tsp_ga&quot;</span><span class="p">,</span>
</span><span id="__span-31-5"><a id="__codelineno-31-5" name="__codelineno-31-5" href="#__codelineno-31-5"></a>    <span class="n">output_directory</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># note: specify an output directory to have results saved to disk</span>
</span><span id="__span-31-6"><a id="__codelineno-31-6" name="__codelineno-31-6" href="#__codelineno-31-6"></a>    <span class="n">seed</span><span class="o">=</span><span class="mi">123456</span><span class="p">,</span>
</span><span id="__span-31-7"><a id="__codelineno-31-7" name="__codelineno-31-7" href="#__codelineno-31-7"></a>    <span class="n">iteration_list</span><span class="o">=</span><span class="mi">2</span> <span class="o">**</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span>
</span><span id="__span-31-8"><a id="__codelineno-31-8" name="__codelineno-31-8" href="#__codelineno-31-8"></a>    <span class="n">population_sizes</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
</span><span id="__span-31-9"><a id="__codelineno-31-9" name="__codelineno-31-9" href="#__codelineno-31-9"></a>    <span class="n">mutation_rates</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
</span><span id="__span-31-10"><a id="__codelineno-31-10" name="__codelineno-31-10" href="#__codelineno-31-10"></a><span class="p">)</span>
</span><span id="__span-31-11"><a id="__codelineno-31-11" name="__codelineno-31-11" href="#__codelineno-31-11"></a>
</span><span id="__span-31-12"><a id="__codelineno-31-12" name="__codelineno-31-12" href="#__codelineno-31-12"></a><span class="c1"># the two data frames will contain the results</span>
</span><span id="__span-31-13"><a id="__codelineno-31-13" name="__codelineno-31-13" href="#__codelineno-31-13"></a><span class="n">df_run_stats</span><span class="p">,</span> <span class="n">df_run_curves</span> <span class="o">=</span> <span class="n">ga</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</span></code></pre></div>
<p>The preceding code will run the <code>GA</code> algorithm nine times for at most 1024 iterations per run.<br />
Each run is a permutation from the list of <code>population_sizes</code> and <code>mutation_rates</code>.</p>
<p>Note that the initial state parameters here are just toy values picked specifically<br />
for this example. You will have to choose your own range of values for your<br />
assignment. I strongly recommend you don't just copy these, or you will find<br />
that the grading is unlikely to go the way you would like.</p>
<p>Really. I mean it... A mutation rate of 0.5 is little better than a pure random search.</p>
<p>The output in the <code>df_run_stats</code> dataframe contains snapshots of the state of the algorithm at the iterations<br />
specified in the <code>iteration_list</code> passed into the runner class.</p>
<p>The first row (corresponding to the first run of this algorithm) are as follows:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="n">df_run_stats</span><span class="p">[[</span><span class="s2">&quot;Iteration&quot;</span><span class="p">,</span> <span class="s2">&quot;Fitness&quot;</span><span class="p">,</span> <span class="s2">&quot;FEvals&quot;</span><span class="p">,</span> <span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="s2">&quot;State&quot;</span><span class="p">]][:</span><span class="mi">1</span><span class="p">]</span>
</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Iteration</th>
      <th>Fitness</th>
      <th>FEvals</th>
      <th>Time</th>
      <th>State</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>2722.031402</td>
      <td>10</td>
      <td>0.00062</td>
      <td>[19, 13, 12, 9, 5, 6, 2, 3, 18, 8, 4, 7, 0, 14...</td>
    </tr>
  </tbody>
</table>
</div>

<p>The state information is excluded from the previous output.</p>
<p>A sample of this is below:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="n">state_sample</span> <span class="o">=</span> <span class="n">df_run_stats</span><span class="p">[[</span><span class="s2">&quot;Population Size&quot;</span><span class="p">,</span> <span class="s2">&quot;Mutation Rate&quot;</span><span class="p">]][:</span><span class="mi">1</span><span class="p">]</span>
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a><span class="n">state_sample</span>
</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Population Size</th>
      <th>Mutation Rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10</td>
      <td>0.1</td>
    </tr>
  </tbody>
</table>
</div>

<p>So, to pick out the most performant run from the dataframe, you need to find the row with the best fitness.<br />
As TSP is a minimization problem, you'd pick the row with the minimum fitness.</p>
<p>However, I'm going to look in the <code>run_curves</code> (which stores minimal basic information every iteration) to<br />
find out which input state achieved the best fitness in the fewest fitness evaluations.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="n">best_fitness</span> <span class="o">=</span> <span class="n">df_run_curves</span><span class="p">[</span><span class="s2">&quot;Fitness&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a><span class="n">best_runs</span> <span class="o">=</span> <span class="n">df_run_curves</span><span class="p">[</span><span class="n">df_run_curves</span><span class="p">[</span><span class="s2">&quot;Fitness&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">best_fitness</span><span class="p">]</span>
</span><span id="__span-34-3"><a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a><span class="n">best_runs</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Iteration</th>
      <th>Time</th>
      <th>Fitness</th>
      <th>FEvals</th>
      <th>Population Size</th>
      <th>Mutation Rate</th>
      <th>max_iters</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3709</th>
      <td>707</td>
      <td>0.296142</td>
      <td>941.582778</td>
      <td>14903.0</td>
      <td>20</td>
      <td>0.1</td>
      <td>1024</td>
    </tr>
    <tr>
      <th>3710</th>
      <td>708</td>
      <td>0.296608</td>
      <td>941.582778</td>
      <td>14924.0</td>
      <td>20</td>
      <td>0.1</td>
      <td>1024</td>
    </tr>
    <tr>
      <th>3711</th>
      <td>709</td>
      <td>0.297102</td>
      <td>941.582778</td>
      <td>14945.0</td>
      <td>20</td>
      <td>0.1</td>
      <td>1024</td>
    </tr>
    <tr>
      <th>3712</th>
      <td>710</td>
      <td>0.297565</td>
      <td>941.582778</td>
      <td>14966.0</td>
      <td>20</td>
      <td>0.1</td>
      <td>1024</td>
    </tr>
    <tr>
      <th>3713</th>
      <td>711</td>
      <td>0.298021</td>
      <td>941.582778</td>
      <td>14987.0</td>
      <td>20</td>
      <td>0.1</td>
      <td>1024</td>
    </tr>
    <tr>
      <th>3714</th>
      <td>712</td>
      <td>0.298481</td>
      <td>941.582778</td>
      <td>15008.0</td>
      <td>20</td>
      <td>0.1</td>
      <td>1024</td>
    </tr>
    <tr>
      <th>3715</th>
      <td>713</td>
      <td>0.298940</td>
      <td>941.582778</td>
      <td>15029.0</td>
      <td>20</td>
      <td>0.1</td>
      <td>1024</td>
    </tr>
    <tr>
      <th>3716</th>
      <td>714</td>
      <td>0.299380</td>
      <td>941.582778</td>
      <td>15050.0</td>
      <td>20</td>
      <td>0.1</td>
      <td>1024</td>
    </tr>
    <tr>
      <th>3717</th>
      <td>715</td>
      <td>0.299820</td>
      <td>941.582778</td>
      <td>15071.0</td>
      <td>20</td>
      <td>0.1</td>
      <td>1024</td>
    </tr>
    <tr>
      <th>3718</th>
      <td>716</td>
      <td>0.300268</td>
      <td>941.582778</td>
      <td>15092.0</td>
      <td>20</td>
      <td>0.1</td>
      <td>1024</td>
    </tr>
  </tbody>
</table>
</div>

<p>This gives us nine candidates for the best run. We are going to pick the one with<br />
that reached the best fitness value in the fewest number of evaluations.</p>
<p>(We could also have chosen to use <code>Iterations</code> as our criteria.)</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="n">minimum_evaluations</span> <span class="o">=</span> <span class="n">best_runs</span><span class="p">[</span><span class="s2">&quot;FEvals&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a><span class="n">best_run</span> <span class="o">=</span> <span class="n">best_runs</span><span class="p">[</span><span class="n">best_runs</span><span class="p">[</span><span class="s2">&quot;FEvals&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">minimum_evaluations</span><span class="p">]</span>
</span></code></pre></div>
<p>The best runs using these criteria is as follows:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="n">best_run</span>
</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Iteration</th>
      <th>Time</th>
      <th>Fitness</th>
      <th>FEvals</th>
      <th>Population Size</th>
      <th>Mutation Rate</th>
      <th>max_iters</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3709</th>
      <td>707</td>
      <td>0.296142</td>
      <td>941.582778</td>
      <td>14903.0</td>
      <td>20</td>
      <td>0.1</td>
      <td>1024</td>
    </tr>
  </tbody>
</table>
</div>

<p>This has the following identifying state information:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a><span class="n">best_mr</span> <span class="o">=</span> <span class="n">best_run</span><span class="p">[</span><span class="s2">&quot;Mutation Rate&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-37-2"><a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a><span class="n">best_pop_size</span> <span class="o">=</span> <span class="n">best_run</span><span class="p">[</span><span class="s2">&quot;Population Size&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-37-3"><a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Best Mutation Rate: </span><span class="si">{</span><span class="n">best_mr</span><span class="si">}</span><span class="s2">, best Population Size: </span><span class="si">{</span><span class="n">best_pop_size</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code>Best Mutation Rate: 0.1, best Population Size: 20
</code></pre></div>
<p>To map this back to the <code>run_stats</code> we look at the configuration data included in<br />
the curve data. The curve data includes at least the minimum identifying information<br />
to determine which run each row came from.</p>
<p>In this case, the values we are looking for are the <code>Mutation Rate</code> and <code>Population Size</code>.</p>
<p>So, we are looking for all rows in <code>df_run_stats</code> where the mutation rate and population size are equal to our best values.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a><span class="n">run_stats_best_run</span> <span class="o">=</span> <span class="n">df_run_stats</span><span class="p">[(</span><span class="n">df_run_stats</span><span class="p">[</span><span class="s2">&quot;Mutation Rate&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">best_mr</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df_run_stats</span><span class="p">[</span><span class="s2">&quot;Population Size&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">best_pop_size</span><span class="p">)]</span>
</span><span id="__span-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a><span class="n">run_stats_best_run</span><span class="p">[[</span><span class="s2">&quot;Iteration&quot;</span><span class="p">,</span> <span class="s2">&quot;Fitness&quot;</span><span class="p">,</span> <span class="s2">&quot;FEvals&quot;</span><span class="p">,</span> <span class="s2">&quot;Time&quot;</span><span class="p">]]</span>
</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Iteration</th>
      <th>Fitness</th>
      <th>FEvals</th>
      <th>Time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>36</th>
      <td>0</td>
      <td>2722.031402</td>
      <td>20</td>
      <td>0.000232</td>
    </tr>
    <tr>
      <th>37</th>
      <td>1</td>
      <td>2141.868537</td>
      <td>42</td>
      <td>0.002583</td>
    </tr>
    <tr>
      <th>38</th>
      <td>2</td>
      <td>2141.868537</td>
      <td>63</td>
      <td>0.004905</td>
    </tr>
    <tr>
      <th>39</th>
      <td>4</td>
      <td>2141.868537</td>
      <td>105</td>
      <td>0.007919</td>
    </tr>
    <tr>
      <th>40</th>
      <td>8</td>
      <td>2044.319536</td>
      <td>190</td>
      <td>0.012401</td>
    </tr>
    <tr>
      <th>41</th>
      <td>16</td>
      <td>1807.055513</td>
      <td>360</td>
      <td>0.019740</td>
    </tr>
    <tr>
      <th>42</th>
      <td>32</td>
      <td>1785.714484</td>
      <td>697</td>
      <td>0.032535</td>
    </tr>
    <tr>
      <th>43</th>
      <td>64</td>
      <td>1479.922718</td>
      <td>1376</td>
      <td>0.059770</td>
    </tr>
    <tr>
      <th>44</th>
      <td>128</td>
      <td>1151.614761</td>
      <td>2731</td>
      <td>0.114027</td>
    </tr>
    <tr>
      <th>45</th>
      <td>256</td>
      <td>1081.456468</td>
      <td>5421</td>
      <td>0.211686</td>
    </tr>
    <tr>
      <th>46</th>
      <td>512</td>
      <td>970.009048</td>
      <td>10803</td>
      <td>0.410439</td>
    </tr>
    <tr>
      <th>47</th>
      <td>1024</td>
      <td>941.582778</td>
      <td>21560</td>
      <td>0.831667</td>
    </tr>
  </tbody>
</table>
</div>

<p>And the best state associated with this is:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a><span class="n">best_state</span> <span class="o">=</span> <span class="n">run_stats_best_run</span><span class="p">[[</span><span class="s2">&quot;State&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-39-2"><a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a><span class="n">best_state</span>
</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>State</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>47</th>
      <td>[9, 0, 19, 17, 14, 15, 16, 8, 12, 5, 1, 6, 18,...</td>
    </tr>
  </tbody>
</table>
</div>

<p>Which results in a graph looking like this:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a><span class="n">ordered_state</span> <span class="o">=</span> <span class="n">literal_eval</span><span class="p">(</span><span class="n">run_stats_best_run</span><span class="p">[</span><span class="s2">&quot;State&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="__span-40-2"><a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a><span class="n">edge_labels</span> <span class="o">=</span> <span class="p">{(</span><span class="n">ordered_state</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ordered_state</span><span class="p">[(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">ordered_state</span><span class="p">)]):</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">‚ûú&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ordered_state</span><span class="p">))}</span>
</span></code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Prepare 2 plots</span>
</span><span id="__span-41-2"><a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
</span><span id="__span-41-3"><a id="__codelineno-41-3" name="__codelineno-41-3" href="#__codelineno-41-3"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
</span><span id="__span-41-4"><a id="__codelineno-41-4" name="__codelineno-41-4" href="#__codelineno-41-4"></a><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">problem</span><span class="o">.</span><span class="n">coords</span><span class="p">):</span>
</span><span id="__span-41-5"><a id="__codelineno-41-5" name="__codelineno-41-5" href="#__codelineno-41-5"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;green&quot;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">5</span> <span class="k">else</span> <span class="s2">&quot;cornflowerblue&quot;</span><span class="p">)</span>  <span class="c1"># plot A</span>
</span><span id="__span-41-6"><a id="__codelineno-41-6" name="__codelineno-41-6" href="#__codelineno-41-6"></a>
</span><span id="__span-41-7"><a id="__codelineno-41-7" name="__codelineno-41-7" href="#__codelineno-41-7"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ordered_state</span><span class="p">)):</span>
</span><span id="__span-41-8"><a id="__codelineno-41-8" name="__codelineno-41-8" href="#__codelineno-41-8"></a>    <span class="n">start_node</span> <span class="o">=</span> <span class="n">ordered_state</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="__span-41-9"><a id="__codelineno-41-9" name="__codelineno-41-9" href="#__codelineno-41-9"></a><span class="n">end_node</span> <span class="o">=</span> <span class="n">ordered_state</span><span class="p">[(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">ordered_state</span><span class="p">)]</span>
</span><span id="__span-41-10"><a id="__codelineno-41-10" name="__codelineno-41-10" href="#__codelineno-41-10"></a><span class="n">start_pos</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">start_node</span><span class="p">]</span>
</span><span id="__span-41-11"><a id="__codelineno-41-11" name="__codelineno-41-11" href="#__codelineno-41-11"></a><span class="n">end_pos</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">end_node</span><span class="p">]</span>
</span><span id="__span-41-12"><a id="__codelineno-41-12" name="__codelineno-41-12" href="#__codelineno-41-12"></a><span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
</span><span id="__span-41-13"><a id="__codelineno-41-13" name="__codelineno-41-13" href="#__codelineno-41-13"></a>    <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="__span-41-14"><a id="__codelineno-41-14" name="__codelineno-41-14" href="#__codelineno-41-14"></a>    <span class="n">xy</span><span class="o">=</span><span class="n">start_pos</span><span class="p">,</span>
</span><span id="__span-41-15"><a id="__codelineno-41-15" name="__codelineno-41-15" href="#__codelineno-41-15"></a>    <span class="n">xycoords</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span>
</span><span id="__span-41-16"><a id="__codelineno-41-16" name="__codelineno-41-16" href="#__codelineno-41-16"></a>    <span class="n">xytext</span><span class="o">=</span><span class="n">end_pos</span><span class="p">,</span>
</span><span id="__span-41-17"><a id="__codelineno-41-17" name="__codelineno-41-17" href="#__codelineno-41-17"></a>    <span class="n">textcoords</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span>
</span><span id="__span-41-18"><a id="__codelineno-41-18" name="__codelineno-41-18" href="#__codelineno-41-18"></a>    <span class="n">c</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span>
</span><span id="__span-41-19"><a id="__codelineno-41-19" name="__codelineno-41-19" href="#__codelineno-41-19"></a>    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;-&gt;&quot;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3&quot;</span><span class="p">),</span>
</span><span id="__span-41-20"><a id="__codelineno-41-20" name="__codelineno-41-20" href="#__codelineno-41-20"></a><span class="p">)</span>
</span><span id="__span-41-21"><a id="__codelineno-41-21" name="__codelineno-41-21" href="#__codelineno-41-21"></a><span class="n">node_labels</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_uppercase</span><span class="p">)</span> <span class="k">if</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">problem</span><span class="o">.</span><span class="n">source_graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">)}</span>
</span><span id="__span-41-22"><a id="__codelineno-41-22" name="__codelineno-41-22" href="#__codelineno-41-22"></a>
</span><span id="__span-41-23"><a id="__codelineno-41-23" name="__codelineno-41-23" href="#__codelineno-41-23"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">node_labels</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="__span-41-24"><a id="__codelineno-41-24" name="__codelineno-41-24" href="#__codelineno-41-24"></a>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="__span-41-25"><a id="__codelineno-41-25" name="__codelineno-41-25" href="#__codelineno-41-25"></a><span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
</span><span id="__span-41-26"><a id="__codelineno-41-26" name="__codelineno-41-26" href="#__codelineno-41-26"></a>    <span class="n">x</span><span class="p">,</span>
</span><span id="__span-41-27"><a id="__codelineno-41-27" name="__codelineno-41-27" href="#__codelineno-41-27"></a>    <span class="n">y</span><span class="p">,</span>
</span><span id="__span-41-28"><a id="__codelineno-41-28" name="__codelineno-41-28" href="#__codelineno-41-28"></a>    <span class="n">node_labels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
</span><span id="__span-41-29"><a id="__codelineno-41-29" name="__codelineno-41-29" href="#__codelineno-41-29"></a>    <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
</span><span id="__span-41-30"><a id="__codelineno-41-30" name="__codelineno-41-30" href="#__codelineno-41-30"></a>    <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
</span><span id="__span-41-31"><a id="__codelineno-41-31" name="__codelineno-41-31" href="#__codelineno-41-31"></a>    <span class="n">c</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
</span><span id="__span-41-32"><a id="__codelineno-41-32" name="__codelineno-41-32" href="#__codelineno-41-32"></a>    <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span>
</span><span id="__span-41-33"><a id="__codelineno-41-33" name="__codelineno-41-33" href="#__codelineno-41-33"></a>    <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;circle,pad=0.15&quot;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s2">&quot;green&quot;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">ordered_state</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">else</span> <span class="s2">&quot;cornflowerblue&quot;</span><span class="p">),</span>
</span><span id="__span-41-34"><a id="__codelineno-41-34" name="__codelineno-41-34" href="#__codelineno-41-34"></a><span class="p">)</span>
</span><span id="__span-41-35"><a id="__codelineno-41-35" name="__codelineno-41-35" href="#__codelineno-41-35"></a>
</span><span id="__span-41-36"><a id="__codelineno-41-36" name="__codelineno-41-36" href="#__codelineno-41-36"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="__span-41-37"><a id="__codelineno-41-37" name="__codelineno-41-37" href="#__codelineno-41-37"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></code></pre></div>
<p><img alt="png" src="../problem_examples_files/problem_examples_80_0.png" /></p>
<p>And, to verify that the route is correct (or at least, the shortest one found):</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a><span class="n">all_edge_lengths</span> <span class="o">=</span> <span class="p">{(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span> <span class="n">d</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">problem</span><span class="o">.</span><span class="n">distances</span><span class="p">}</span>
</span><span id="__span-42-2"><a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a><span class="n">all_edge_lengths</span><span class="o">.</span><span class="n">update</span><span class="p">({(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span> <span class="n">d</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">problem</span><span class="o">.</span><span class="n">distances</span><span class="p">})</span>
</span><span id="__span-42-3"><a id="__codelineno-42-3" name="__codelineno-42-3" href="#__codelineno-42-3"></a>
</span><span id="__span-42-4"><a id="__codelineno-42-4" name="__codelineno-42-4" href="#__codelineno-42-4"></a><span class="n">route_length</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">all_edge_lengths</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">edge_labels</span><span class="o">.</span><span class="n">keys</span><span class="p">()])</span>
</span><span id="__span-42-5"><a id="__codelineno-42-5" name="__codelineno-42-5" href="#__codelineno-42-5"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;route_length: (</span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">route_length</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span><span class="si">}</span><span class="s2">) equal to best_fitness: (</span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">best_fitness</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code>route_length: (941.582778) equal to best_fitness: (941.582778)
</code></pre></div>
<h2 id="example-4-using-the-nngsrunner-with-the-rhc-algorithm">Example 4: Using the NNGSRunner with the RHC algorithm<a class="headerlink" href="#example-4-using-the-nngsrunner-with-the-rhc-algorithm" title="Permanent link">#</a></h2>
<div class="language-python highlight"><pre><span></span><code><span id="__span-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a><span class="c1"># Load and Split data into training and test sets</span>
</span><span id="__span-43-2"><a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a><span class="n">data</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">()</span>
</span><span id="__span-43-3"><a id="__codelineno-43-3" name="__codelineno-43-3" href="#__codelineno-43-3"></a><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
</span><span id="__span-43-4"><a id="__codelineno-43-4" name="__codelineno-43-4" href="#__codelineno-43-4"></a>    <span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123456</span>
</span><span id="__span-43-5"><a id="__codelineno-43-5" name="__codelineno-43-5" href="#__codelineno-43-5"></a><span class="p">)</span>
</span><span id="__span-43-6"><a id="__codelineno-43-6" name="__codelineno-43-6" href="#__codelineno-43-6"></a>
</span><span id="__span-43-7"><a id="__codelineno-43-7" name="__codelineno-43-7" href="#__codelineno-43-7"></a><span class="c1"># Normalize feature data</span>
</span><span id="__span-43-8"><a id="__codelineno-43-8" name="__codelineno-43-8" href="#__codelineno-43-8"></a><span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
</span><span id="__span-43-9"><a id="__codelineno-43-9" name="__codelineno-43-9" href="#__codelineno-43-9"></a><span class="n">X_train_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</span><span id="__span-43-10"><a id="__codelineno-43-10" name="__codelineno-43-10" href="#__codelineno-43-10"></a><span class="n">X_test_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="__span-43-11"><a id="__codelineno-43-11" name="__codelineno-43-11" href="#__codelineno-43-11"></a>
</span><span id="__span-43-12"><a id="__codelineno-43-12" name="__codelineno-43-12" href="#__codelineno-43-12"></a><span class="c1"># One hot encode target values</span>
</span><span id="__span-43-13"><a id="__codelineno-43-13" name="__codelineno-43-13" href="#__codelineno-43-13"></a><span class="n">one_hot</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">()</span>
</span><span id="__span-43-14"><a id="__codelineno-43-14" name="__codelineno-43-14" href="#__codelineno-43-14"></a><span class="n">y_train_hot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">one_hot</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y_train</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">todense</span><span class="p">())</span>
</span><span id="__span-43-15"><a id="__codelineno-43-15" name="__codelineno-43-15" href="#__codelineno-43-15"></a><span class="n">y_test_hot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">one_hot</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">y_test</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">todense</span><span class="p">())</span>
</span><span id="__span-43-16"><a id="__codelineno-43-16" name="__codelineno-43-16" href="#__codelineno-43-16"></a>
</span><span id="__span-43-17"><a id="__codelineno-43-17" name="__codelineno-43-17" href="#__codelineno-43-17"></a><span class="n">grid_search_parameters</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-43-18"><a id="__codelineno-43-18" name="__codelineno-43-18" href="#__codelineno-43-18"></a>    <span class="s1">&#39;max_iters&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1000</span><span class="p">],</span>  <span class="c1"># nn params</span>
</span><span id="__span-43-19"><a id="__codelineno-43-19" name="__codelineno-43-19" href="#__codelineno-43-19"></a>    <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1e-2</span><span class="p">],</span>  <span class="c1"># nn params</span>
</span><span id="__span-43-20"><a id="__codelineno-43-20" name="__codelineno-43-20" href="#__codelineno-43-20"></a>    <span class="s1">&#39;activation&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">mlrose</span><span class="o">.</span><span class="n">relu</span><span class="p">],</span>  <span class="c1"># nn params</span>
</span><span id="__span-43-21"><a id="__codelineno-43-21" name="__codelineno-43-21" href="#__codelineno-43-21"></a>    <span class="s1">&#39;restarts&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span>  <span class="c1"># rhc params</span>
</span><span id="__span-43-22"><a id="__codelineno-43-22" name="__codelineno-43-22" href="#__codelineno-43-22"></a><span class="p">}</span>
</span><span id="__span-43-23"><a id="__codelineno-43-23" name="__codelineno-43-23" href="#__codelineno-43-23"></a>
</span><span id="__span-43-24"><a id="__codelineno-43-24" name="__codelineno-43-24" href="#__codelineno-43-24"></a><span class="n">nnr</span> <span class="o">=</span> <span class="n">NNGSRunner</span><span class="p">(</span><span class="n">x_train</span><span class="o">=</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="o">=</span><span class="n">y_train_hot</span><span class="p">,</span> <span class="n">x_test</span><span class="o">=</span><span class="n">X_test_scaled</span><span class="p">,</span> <span class="n">y_test</span><span class="o">=</span><span class="n">y_test_hot</span><span class="p">,</span> <span class="n">experiment_name</span><span class="o">=</span><span class="s1">&#39;nn_test_rhc&#39;</span><span class="p">,</span>
</span><span id="__span-43-25"><a id="__codelineno-43-25" name="__codelineno-43-25" href="#__codelineno-43-25"></a>                 <span class="n">algorithm</span><span class="o">=</span><span class="n">mlrose</span><span class="o">.</span><span class="n">algorithms</span><span class="o">.</span><span class="n">rhc</span><span class="o">.</span><span class="n">random_hill_climb</span><span class="p">,</span> <span class="n">grid_search_parameters</span><span class="o">=</span><span class="n">grid_search_parameters</span><span class="p">,</span>
</span><span id="__span-43-26"><a id="__codelineno-43-26" name="__codelineno-43-26" href="#__codelineno-43-26"></a>                 <span class="n">iteration_list</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span> <span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">[[</span><span class="mi">2</span><span class="p">]],</span> <span class="n">clip_max</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">123456</span><span class="p">)</span>
</span><span id="__span-43-27"><a id="__codelineno-43-27" name="__codelineno-43-27" href="#__codelineno-43-27"></a>
</span><span id="__span-43-28"><a id="__codelineno-43-28" name="__codelineno-43-28" href="#__codelineno-43-28"></a><span class="n">run_stats_df</span><span class="p">,</span> <span class="n">curves_df</span><span class="p">,</span> <span class="n">cv_results_df</span><span class="p">,</span> <span class="n">grid_search_cv</span> <span class="o">=</span> <span class="n">nnr</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code>Fitting 5 folds for each of 1 candidates, totalling 5 fits
</code></pre></div>
<p>The runner returns the <code>run_stats</code> and <code>curves</code> corresponding to <em>best</em> hyperparameter combination,<br />
as well as the cross validation results and the underlying <code>GridSearchCV</code> object used in the run.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-44-1"><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a><span class="n">y_test_pred</span> <span class="o">=</span> <span class="n">grid_search_cv</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">)</span>
</span><span id="__span-44-2"><a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a><span class="n">y_test_accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y_test_hot</span><span class="p">),</span> <span class="n">y_test_pred</span><span class="p">)</span>
</span><span id="__span-44-3"><a id="__codelineno-44-3" name="__codelineno-44-3" href="#__codelineno-44-3"></a><span class="n">y_test_accuracy</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code>0.3333333333333333
</code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-45-1"><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a><span class="n">y_train_pred</span> <span class="o">=</span> <span class="n">grid_search_cv</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">)</span>
</span><span id="__span-45-2"><a id="__codelineno-45-2" name="__codelineno-45-2" href="#__codelineno-45-2"></a><span class="n">y_train_accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_train_hot</span><span class="p">,</span> <span class="n">y_train_pred</span><span class="p">)</span>
</span><span id="__span-45-3"><a id="__codelineno-45-3" name="__codelineno-45-3" href="#__codelineno-45-3"></a><span class="n">y_train_accuracy</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code>0.3333333333333333
</code></pre></div>
<p>Run stats dataframe</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-46-1"><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a><span class="n">run_stats_df</span><span class="p">[[</span><span class="s2">&quot;current_restart&quot;</span><span class="p">,</span> <span class="s2">&quot;Iteration&quot;</span><span class="p">,</span> <span class="s2">&quot;Fitness&quot;</span><span class="p">,</span> <span class="s2">&quot;FEvals&quot;</span><span class="p">,</span> <span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="s2">&quot;learning_rate&quot;</span><span class="p">]][:</span><span class="mi">14</span><span class="p">]</span>
</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>current_restart</th>
      <th>Iteration</th>
      <th>Fitness</th>
      <th>FEvals</th>
      <th>Time</th>
      <th>learning_rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>1.306448</td>
      <td>1</td>
      <td>0.001905</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>1</td>
      <td>1.290536</td>
      <td>3</td>
      <td>0.004327</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>10</td>
      <td>1.246087</td>
      <td>14</td>
      <td>0.009143</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>50</td>
      <td>1.115004</td>
      <td>67</td>
      <td>0.027937</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>100</td>
      <td>1.044654</td>
      <td>127</td>
      <td>0.048129</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0</td>
      <td>250</td>
      <td>0.877647</td>
      <td>308</td>
      <td>0.107263</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0</td>
      <td>500</td>
      <td>0.739120</td>
      <td>614</td>
      <td>0.212110</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0</td>
      <td>1000</td>
      <td>0.732424</td>
      <td>1175</td>
      <td>0.433252</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1</td>
      <td>0</td>
      <td>1.306448</td>
      <td>1175</td>
      <td>0.436525</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1</td>
      <td>1</td>
      <td>1.306448</td>
      <td>1176</td>
      <td>0.438441</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1</td>
      <td>10</td>
      <td>1.247648</td>
      <td>1188</td>
      <td>0.444550</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>11</th>
      <td>1</td>
      <td>50</td>
      <td>1.148455</td>
      <td>1239</td>
      <td>0.465959</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>12</th>
      <td>1</td>
      <td>100</td>
      <td>1.105441</td>
      <td>1298</td>
      <td>0.491722</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>13</th>
      <td>1</td>
      <td>250</td>
      <td>0.931072</td>
      <td>1490</td>
      <td>0.570107</td>
      <td>0.01</td>
    </tr>
  </tbody>
</table>
</div>

<p>curves dataframe</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-47-1"><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a><span class="n">curves_df</span><span class="p">[[</span><span class="s2">&quot;current_restart&quot;</span><span class="p">,</span> <span class="s2">&quot;Iteration&quot;</span><span class="p">,</span> <span class="s2">&quot;Fitness&quot;</span><span class="p">,</span> <span class="s2">&quot;FEvals&quot;</span><span class="p">,</span> <span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="s2">&quot;learning_rate&quot;</span><span class="p">]][:</span><span class="mi">20</span><span class="p">]</span>
</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>current_restart</th>
      <th>Iteration</th>
      <th>Fitness</th>
      <th>FEvals</th>
      <th>Time</th>
      <th>learning_rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>1.290536</td>
      <td>1.0</td>
      <td>0.001905</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>1</td>
      <td>1.290536</td>
      <td>3.0</td>
      <td>0.004327</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>2</td>
      <td>1.290536</td>
      <td>4.0</td>
      <td>0.005450</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>3</td>
      <td>1.290536</td>
      <td>5.0</td>
      <td>0.005843</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>4</td>
      <td>1.263664</td>
      <td>7.0</td>
      <td>0.006530</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0</td>
      <td>5</td>
      <td>1.263664</td>
      <td>8.0</td>
      <td>0.006857</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0</td>
      <td>6</td>
      <td>1.246087</td>
      <td>10.0</td>
      <td>0.007742</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0</td>
      <td>7</td>
      <td>1.246087</td>
      <td>11.0</td>
      <td>0.008119</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0</td>
      <td>8</td>
      <td>1.246087</td>
      <td>12.0</td>
      <td>0.008459</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0</td>
      <td>9</td>
      <td>1.246087</td>
      <td>13.0</td>
      <td>0.008787</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>10</th>
      <td>0</td>
      <td>10</td>
      <td>1.246087</td>
      <td>14.0</td>
      <td>0.009143</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0</td>
      <td>11</td>
      <td>1.246087</td>
      <td>15.0</td>
      <td>0.010364</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>12</th>
      <td>0</td>
      <td>12</td>
      <td>1.246087</td>
      <td>16.0</td>
      <td>0.010792</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>13</th>
      <td>0</td>
      <td>13</td>
      <td>1.246087</td>
      <td>17.0</td>
      <td>0.011168</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>14</th>
      <td>0</td>
      <td>14</td>
      <td>1.246087</td>
      <td>18.0</td>
      <td>0.011561</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>15</th>
      <td>0</td>
      <td>15</td>
      <td>1.246087</td>
      <td>19.0</td>
      <td>0.011916</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>16</th>
      <td>0</td>
      <td>16</td>
      <td>1.246087</td>
      <td>20.0</td>
      <td>0.012291</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>17</th>
      <td>0</td>
      <td>17</td>
      <td>1.232142</td>
      <td>22.0</td>
      <td>0.013562</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>18</th>
      <td>0</td>
      <td>18</td>
      <td>1.216927</td>
      <td>24.0</td>
      <td>0.014337</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>19</th>
      <td>0</td>
      <td>19</td>
      <td>1.216927</td>
      <td>25.0</td>
      <td>0.014832</td>
      <td>0.01</td>
    </tr>
  </tbody>
</table>
</div>

<p>cv results dataframe</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-48-1"><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a><span class="n">cv_results_df</span><span class="p">[</span>
</span><span id="__span-48-2"><a id="__codelineno-48-2" name="__codelineno-48-2" href="#__codelineno-48-2"></a>    <span class="p">[</span>
</span><span id="__span-48-3"><a id="__codelineno-48-3" name="__codelineno-48-3" href="#__codelineno-48-3"></a>        <span class="s2">&quot;mean_test_score&quot;</span><span class="p">,</span>
</span><span id="__span-48-4"><a id="__codelineno-48-4" name="__codelineno-48-4" href="#__codelineno-48-4"></a>        <span class="s2">&quot;rank_test_score&quot;</span><span class="p">,</span>
</span><span id="__span-48-5"><a id="__codelineno-48-5" name="__codelineno-48-5" href="#__codelineno-48-5"></a>        <span class="s2">&quot;mean_train_score&quot;</span><span class="p">,</span>
</span><span id="__span-48-6"><a id="__codelineno-48-6" name="__codelineno-48-6" href="#__codelineno-48-6"></a>        <span class="s2">&quot;param_activation&quot;</span><span class="p">,</span>
</span><span id="__span-48-7"><a id="__codelineno-48-7" name="__codelineno-48-7" href="#__codelineno-48-7"></a>        <span class="s2">&quot;param_hidden_layer_sizes&quot;</span><span class="p">,</span>
</span><span id="__span-48-8"><a id="__codelineno-48-8" name="__codelineno-48-8" href="#__codelineno-48-8"></a>        <span class="s2">&quot;param_learning_rate&quot;</span><span class="p">,</span>
</span><span id="__span-48-9"><a id="__codelineno-48-9" name="__codelineno-48-9" href="#__codelineno-48-9"></a>        <span class="s2">&quot;param_max_iters&quot;</span><span class="p">,</span>
</span><span id="__span-48-10"><a id="__codelineno-48-10" name="__codelineno-48-10" href="#__codelineno-48-10"></a>        <span class="s2">&quot;param_restarts&quot;</span><span class="p">,</span>
</span><span id="__span-48-11"><a id="__codelineno-48-11" name="__codelineno-48-11" href="#__codelineno-48-11"></a>    <span class="p">]</span>
</span><span id="__span-48-12"><a id="__codelineno-48-12" name="__codelineno-48-12" href="#__codelineno-48-12"></a><span class="p">]</span>
</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean_test_score</th>
      <th>rank_test_score</th>
      <th>mean_train_score</th>
      <th>param_activation</th>
      <th>param_hidden_layer_sizes</th>
      <th>param_learning_rate</th>
      <th>param_max_iters</th>
      <th>param_restarts</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.333333</td>
      <td>1</td>
      <td>0.333333</td>
      <td>relu</td>
      <td>[2]</td>
      <td>0.01</td>
      <td>1000</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../runners/" class="btn btn-neutral float-left" title="4 - How to use Runners for Optimization Problems?"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../tutorial_examples/" class="btn btn-neutral float-right" title="2 - Fitness function in code">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../runners/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../tutorial_examples/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../javascripts/mathjax.js"></script>
      <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
